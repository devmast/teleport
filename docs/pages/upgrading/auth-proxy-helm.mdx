---
title: Upgrading the Auth Service and Proxy Service on Kubernetes
description: Explains how to upgrade the Teleport Auth Service and Proxy Service when self-hosting Teleport on Kubernetes
---

This guide explains how to upgrade Teleport Auth Service and Proxy Service
instances running on Kubernetes.

{/*TODO: More context, e.g., what to do re: agents*/}

## Prerequisites

- A Teleport cluster deployed with the `teleport-cluster` Helm chart. 
- **Recommended:** A recent backup of your Teleport cluster state. Read the
  [Backing up Teleport](../management/operations/backup-restore.mdx) guide for
  backup instructions.

This guide assumes that you have configured the `teleport-cluster` Helm chart
with a values file called `values.yaml`. 

## Step 1/2. Edit your `teleport-cluster` values file

You must reduce the number of Auth Service instances to one in order to ensure a
consistent cluster state and enable the Auth Service to perform any data
migrations.

Ensure that your `teleport-cluster` values file includes the followinmg
configuration:

```yaml
auth
  highAvailability
    replicaCount: 1
```

 Once the upgrade is finished, you can configure your cluster for high
 availability again.

## Step 2/2. Upgrade your `teleport-cluster` Helm release

Run the following commands to upgrade Auth Service and Proxy Service instances
running on Kubernetes.

1. Update the Teleport Helm chart repository so you can install the latest
   version of the `teleport-cluster` chart:

  (!docs/pages//kubernetes-access/helm/includes/helm-repo-add.mdx!)

1. Upgrade the Helm release:

  ```code
  helm upgrade --version=(=teleport.version=) --values=values.yaml
  ```

The `teleport-cluster` Helm chart automatically waits for the previous version
of the Proxy Service to stop responding to requests before running a new version
of the Auth Service.

## Next steps

{/*TODO: links to guides for upgrading agents*/}
