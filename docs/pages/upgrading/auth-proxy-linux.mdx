---
title: Upgrading Self-Hosted Teleport Clusters on Linux
description: Explains how to upgrade Teleport Auth Service and Proxy Service instances running on Linux servers.
---

This guide explains how to upgrade the Teleport Auth Service and Proxy Service
for self-hosted Teleport deployments running on Linux servers. 

## Prerequisites

- Familiarity with the [Upgrading Compatibility Overview](./overview.mdx) guide,
  which describes the sequence in which to upgrade components of your cluster.
- A self-hosted Teleport cluster in which the Auth Service and Proxy Service run
  on Linux servers. Auth Service and Proxy Service instances must be running a
  previous version of Teleport.

## Step 1/2. Install the latest Teleport version

{/*TODO: intro paragraph re: how the below steps figure into upgrading
Teleport*/}

Open a terminal and export the Teleport edition as an environment variable
called `TELEPORT_EDITION`. Use the following table to choose the value:

|Edition|Value|
|---|---|
|Teleport Community Edition|`teleport`|
|Teleport Team, Enterprise, and Enterprise Cloud|`teleport-ent`|
|Teleport Entrprise (FIPS builds)|`teleport-ent-fips`|

```code
$ export TELEPORT_EDITION="teleport-ent"
```

Run the following commands to install the latest version of Teleport on your
Linux server:

<Tabs>
<TabItem label="Debian 9+/Ubuntu 16.04+ (apt)">

```code
# Download Teleport's PGP public key
$ sudo curl https://apt.releases.teleport.dev/gpg \
-o /usr/share/keyrings/teleport-archive-keyring.asc
# Source variables about OS version
$ source /etc/os-release
# Add the Teleport APT repository for v(=teleport.major_version=). You'll need to update this
# file for each major release of Teleport.
$ echo "deb [signed-by=/usr/share/keyrings/teleport-archive-keyring.asc] \
https://apt.releases.teleport.dev/${ID?} ${VERSION_CODENAME?} stable/v(=teleport.major_version=)" \
| sudo tee /etc/apt/sources.list.d/teleport.list > /dev/null

$ sudo apt-get update
$ sudo apt-get install ${TELEPORT_EDITION:=teleport}
```

</TabItem>
<TabItem label="Amazon Linux 2/RHEL 7 (yum)">

```code
# Source variables about OS version
$ source /etc/os-release
# Add the Teleport YUM repository for v(=teleport.major_version=). You'll need to update this
# file for each major release of Teleport.
# First, get the major version from $VERSION_ID so this fetches the correct
# package version.
$ VERSION_ID=$(echo $VERSION_ID | grep -Eo "^[0-9]+")
$ sudo yum-config-manager --add-repo "$(rpm --eval "https://yum.releases.teleport.dev/$ID/$VERSION_ID/Teleport/%{_arch}/stable/v(=teleport.major_version=)/teleport.repo")"
$ sudo yum install ${TELEPORT_EDITION:=teleport}
#
# Tip: Add /usr/local/bin to path used by sudo (so 'sudo tctl users add' will work as per the docs)
# echo "Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin:/usr/local/bin" > /etc/sudoers.d/secure_path
```

</TabItem>
<TabItem label="Amazon Linux 2/RHEL 7 (zypper)">

```code
# Source variables about OS version
$ source /etc/os-release
# Add the Teleport Zypper repository for v(=teleport.major_version=). You'll need to update this
# file for each major release of Teleport.
# First, get the OS major version from $VERSION_ID so this fetches the correct
# package version.
$ VERSION_ID=$(echo $VERSION_ID | grep -Eo "^[0-9]+")
# Use zypper to add the teleport RPM repo
$ sudo zypper addrepo --refresh --repo $(rpm --eval "https://zypper.releases.teleport.dev/$ID/$VERSION_ID/Teleport/%{_arch}/stable/cloud/teleport-zypper.repo")
$ sudo yum install ${TELEPORT_EDITION:=teleport}
#
# Tip: Add /usr/local/bin to path used by sudo (so 'sudo tctl users add' will work as per the docs)
# echo "Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin:/usr/local/bin" > /etc/sudoers.d/secure_path
```

</TabItem>
<TabItem label="Amazon Linux 2023/RHEL 8+ (dnf)">

```code
# Source variables about OS version
$ source /etc/os-release
# Add the Teleport YUM repository for v(=teleport.major_version=). You'll need to update this
# file for each major release of Teleport.
# First, get the major version from $VERSION_ID so this fetches the correct
# package version.
$ VERSION_ID=$(echo $VERSION_ID | grep -Eo "^[0-9]+")
# Use the dnf config manager plugin to add the teleport RPM repo
$ sudo dnf config-manager --add-repo "$(rpm --eval "https://yum.releases.teleport.dev/$ID/$VERSION_ID/Teleport/%{_arch}/stable/v(=teleport.major_version=)/teleport.repo")"

# Install teleport
$ sudo dnf install ${TELEPORT_EDITION:=teleport}

# Tip: Add /usr/local/bin to path used by sudo (so 'sudo tctl users add' will work as per the docs)
# echo "Defaults    secure_path = /sbin:/bin:/usr/sbin:/usr/bin:/usr/local/bin" > /etc/sudoers.d/secure_path
```

</TabItem>
<TabItem label="SLES 12 SP5+ and 15 SP5+ (zypper)">

```code
# Source variables about OS version
$ source /etc/os-release
# Add the Teleport Zypper repository.
# First, get the OS major version from $VERSION_ID so this fetches the correct
# package version.
$ VERSION_ID=$(echo $VERSION_ID | grep -Eo "^[0-9]+")
# Use Zypper to add the teleport RPM repo
$ sudo zypper addrepo --refresh --repo $(rpm --eval "https://zypper.releases.teleport.dev/$ID/$VERSION_ID/Teleport/%{_arch}/stable/v(=teleport.major_version=)/teleport-zypper.repo")

# Install teleport
$ sudo zypper install ${TELEPORT_EDITION:=teleport}
```

</TabItem>
<TabItem label="Tarball" >

In the example commands below, update `$SYSTEM_ARCH` with the appropriate
value (`amd64`, `arm64`, or `arm`). All example commands using this variable
will update after one is filled out.

```code
$ curl https://get.gravitational.com/${TELEPORT_EDITION:=teleport}-v(=teleport.version=)-linux-<Var name="$SYSTEM_ARCH"/>-bin.tar.gz.sha256
# <checksum> <filename>
$ curl -O https://cdn.teleport.dev/${TELEPORT_EDITION:=teleport}-v(=teleport.version=)-linux-<Var name="$SYSTEM_ARCH"/>-bin.tar.gz
$ shasum -a 256 ${TELEPORT_EDITION:=teleport}-v(=teleport.version=)-linux-<Var name="$SYSTEM_ARCH"/>-bin.tar.gz
# Verify that the checksums match
$ tar -xvf ${TELEPORT_EDITION:=teleport}-v(=teleport.version=)-linux-<Var name="$SYSTEM_ARCH"/>-bin.tar.gz
$ cd ${TELEPORT_EDITION:=teleport}
$ sudo ./install
```

</TabItem>
</Tabs>

## Step 2/2. Restart Teleport

Now that you have installed a more recent `teleport` binary on your Auth Service
and Proxy Service servers, restart Teleport on these servers to run the new
version.

(!docs/pages/includes/start-teleport.mdx!)

## Next steps

Now that you have upgraded the Auth Service and Proxy Service, you can upgrade
the agents in your Teleport cluster.

We recommend that Teleport users set up automatic agent upgrades, where agents
query a **version server** in order to determine whether they are out of date
and need to install a new version of Teleport. Read one of the following guides
to set up automatic agent upgrades:

- [Self-hosted Teleport clusters](./upgrading//self-hosted-automatic-agent-updates.mdx)
- [Teleport Cloud](./upgrading//enroll-agent-into-automatic-updates.mdx)

For special circumstances, you can also read about how to upgrade agents
manually in your environment (the instructions are the same for self-hosted and
Teleport Cloud clusters):

- [Kubernetes](./upgrading/agents-helm.mdx)
- [Linux Servers](./upgrading/agents-linux.mdx)

